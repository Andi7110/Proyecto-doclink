{% extends "paciente/dashboard_base.html" %}
{% block content %}
<div class="row mt-4 align-items-center">
  <div class="col-12 col-lg-8 d-flex flex-wrap align-items-center gap-2 mb-3">
    <h2 class="mb-0">¡Bienvenido {{ request.user.nombre }} {{ request.user.apellido }}! </h2>
  </div>
  <div class="col-12 col-lg-4 d-flex justify-content-lg-end mt-2 mt-lg-0">
    <div class="card shadow-sm p-3 text-center" style="min-width: 180px; width: 200px;">
      <h6>Comunidad</h6>
      <h2 class="mb-0" style="font-weight:bold;">100,353</h2>
      <small class="text-muted">último año</small>
    </div>
  </div>
</div>

<a href="{% url 'mapa_medicos' %}" class="btn btn-info">📍 Ver médicos en el mapa</a>
<!-- Botones principales -->
<!-- Botón agregar póliza -->
<div class="d-flex flex-wrap gap-2 mb-4 mt-2">
  <a href="{% url 'agregar_poliza' %}" class="btn btn-primary">
    Agregar Póliza
</a>
<!-- Botón para agregar/editar contacto de emergencia -->
  <a href="{% url 'contacto_emergencia' %}" class="btn btn-warning">
    Contacto de Emergencia
  </a>
  <button class="btn btn-danger btn-custom">Cancelar cita</button>
  <div class="dropdown">
    <button class="btn btn-info btn-custom text-white dropdown-toggle" style="background:#0099ff;" type="button"
      data-bs-toggle="dropdown" aria-expanded="false">
      Recetas
    </button>
    <ul class="dropdown-menu">
      <li><a class="dropdown-item" href="#">Ver recetas</a></li>
      <li><a class="dropdown-item" href="#">Descargar PDF</a></li>
    </ul>
  </div>
  <div class="dropdown">
    <button class="btn btn-info btn-custom text-white dropdown-toggle" style="background:#0076b5;" type="button"
      data-bs-toggle="dropdown" aria-expanded="false">
      Cuadro Clinico
    </button>
    <ul class="dropdown-menu">
      <li><a class="dropdown-item" href="#">Ver cuadro</a></li>
    </ul>
  </div>
</div>

<div class="row gx-4">
  <!-- Panel izquierdo: Buscar Medico -->
  <div class="col-12 col-lg-6 mb-4">
    <div class="card shadow-sm p-3 h-100">

<div class="d-flex justify-content-between align-items-center mb-3">
  <span class="fw-bold" style="font-size:1.5rem;">Buscar Médico</span>
  <form method="get" action="{% url 'buscar_medicos' %}" class="ms-auto d-flex" style="min-width: 250px; max-width: 320px; width: 100%;">
    <select name="tipo_filtro" class="form-select me-2">
      <option value="todo" {% if request.GET.tipo_filtro == "todo" %}selected{% endif %}>Todo</option>
      <option value="nombre" {% if request.GET.tipo_filtro == "nombre" %}selected{% endif %}>Nombre</option>
      <option value="especialidad" {% if request.GET.tipo_filtro == "especialidad" %}selected{% endif %}>Especialidad</option>
      <option value="ubicacion" {% if request.GET.tipo_filtro == "ubicacion" %}selected{% endif %}>Ubicación</option>
    </select>

    <input type="search" name="q" class="form-control me-2" placeholder="Buscar..." value="{{ request.GET.q }}">
    <button class="btn btn-success" type="submit">🔍</button>
  </form>
</div>

        <div class="row">
        <!-- Info médico -->
        <div class="col-md-6 border-end">
          <h6 style="font-weight: bold;"></h6>
          <p class="mb-3" style="font-size: 1rem;">
            
          </p>
        </div>
        <!-- Puntaje y botón -->
        <div class="col-md-6 d-flex flex-column align-items-center justify-content-between">
          <div>
            <h6 style="font-weight: bold;">Puntuacion de medico</h6>
            <span class="rating-stars" style="font-size:2rem;">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
          </div>
          <a href="{% url 'agendar_cita' %}" class="btn btn-info mt-4 w-75 text-white" style="background:#00b8e6; display: inline-block; text-align: center;">
              <b>+ Agendar cita</b>
          </a>
        </div>
      </div>
    </div>
  </div>
  <!-- Panel derecho: Ranking de Médicos -->
  <div class="col-12 mb-4">
    <div class="card shadow-sm p-3 h-100">
      <h6 class="mb-3" style="font-weight:bold;">Ranking de Medicos</h6>
      <p class="mb-3">Consulta el ranking completo de médicos basado en calificaciones de pacientes.</p>
      <a href="{% url 'ranking_medico' %}" class="btn btn-primary w-100">Ver Ranking Completo</a>
    </div>
  </div>
</div>
{% endblock %}